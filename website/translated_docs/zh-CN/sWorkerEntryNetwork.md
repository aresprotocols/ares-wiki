---
id: technicalFramework
title: 技术框架
sidebar_label: 技术框架
---
## 参与者

![](assets/build/2.png)

## 聚合器

聚合器通过Scanner获取外部请求数据，将请求发送给处理器处理所有Oracle请求。通过 VRF 算法随机选择一个聚合器。它调用处理器聚合来自多个数据源的数据并提交给区块，并通过区块传播协议广播到Ares网络。

### 挑战者

挑战者验证聚合器提交的数据的完整性和有效性，并将欺诈性聚合器交易和正确数据提交给声誉委员会以获得奖励。### 声誉委员会

通过激励挑战者和惩罚恶意聚合者，确保了区域网络的安全。声誉委员会完全由社区自治，通过代币抵押和声誉加权的方式竞选声誉委员会。声誉委员会的内部仲裁需要通过FSP欺诈安全协议进行投票，并且只有在链上发生争议时才运行。

### 数据消费者

数据消费者可以是智能合约、平行链和 DAPP 中需要获取外部数据的对象。他们可以为DEFI、市场预测和赌博提供各种可信有效的数据。由于Ares的链上数据具有一定的数据挑战期，因此数据消费者应按照一定的安全规定获取链上数据。

### 节点操作符

节点运营商作为 Ares 网络的全节点，通过与本地存储的数据进行比较来验证数据，以确保 Ares 网络的安全并提供 Oracle RPC 服务。

### 详细设计
![](assets/build/3.png)

Ares 协议基于 Substrate 2.0，用作并行链/并行线程连接到 Polkadot 生态系统。具体流程如下：

1,Polkadot生态平行链，通过集成Ares oracle托盘，提交数据请求；

2,Scanner 获取外部请求数据并提交给聚合器；

3,Ares Chain 通过 VRF 算法随机选择一个聚合器；

4,聚合器调用处理器聚合来自多个数据源的数据并提交到Ares区块链；

5,验证节点将验证聚合器和挑战的数据；

6,声誉委员会对挑战者提交的数据进行核实并进行仲裁。


### 如何解决去中心化？

Ares提出了两种解决方案，尽可能避免问题节点的出现，即分布式数据源和分布式预言机。

### 分布式数据源

每个节点算子从多个不同的数据源获取数据，以减少异常数据源对结果的影响。聚合函数可以将多个返回的结果聚合为一个答案。完成数据聚合的方案有很多，比如去除异常数据后的加权平均。数据源之间可能会相互获取数据，这也可能导致聚合结果出现错误。我们将继续关注此类问题，并报告数据来源的独立性。

### 分布式聚合器

聚合者（即矿工）主要负责提供各类数据，挑战者（即验证者）对数据提供者提供的各种数据进行验证和挑战，并将其发送给议会（仲裁机构）。声誉委员会对数据验证者提出的挑战进行仲裁，如果验证通过，则奖励挑战者并惩罚聚合者。

在所有提供数据报价的聚合矿工节点中，Ares Network使用可验证随机函数（VRF）随机选择一组聚合节点进行竞争，以提供最准确的市场数据。通过在系统中引入 VRF，可以显着提高系统的分散程度。通过 VRF 随机选择聚合节点提供链上外部数据。

![](assets/build/4.png)

经过 VRF 的计算，Ares 可以选择聚合器，最终确定某个聚合器在当前高度出块，并通过零知识证明来验证聚合器。这部分会在出块的同时广播，普通验证节点收到块后进行验证。如果在允许偏差范围内，则验证通过。

### 名誉委员会治理

80年代开始研究BFT（拜占庭容错）算法来解决所谓的拜占庭将军问题。最著名的 BFT 算法是 PBFT，它是一种基于消息传递的共识算法。在弱同步网络中，算法可以通过三个阶段达到一致性，复杂度为O(n2)。当无法达成一致时，这些阶段将重复直到超时。

PBFT的优点是收敛速度快，节省资源，理论安全圈（理论上允许不超过1/3的恶意节点存在，即节点总数为3k+1，当有超过2k + 1个正常节点，算法正常工作）。

![](assets/build/5.png)

理事会成员从聚合者或代币持有者中选出，声誉值和代币持有量之间存在映射关系。确保理事会成员不会被货币持有者操纵。每当聚合器提交正确的数据时，其声誉值就会增加。将保留理事会成员名单和等待队列，并且每个月都会更新理事会成员。理事会只能批准或拒绝挑战者提交的欺诈证明。

由于挑战是支付一定数量的 GAS 费用，因此理事会在正常情况下不需要工作。它只需要在验证者提交欺诈证明时处理争议，并可以将欺诈证明提交给理事会。如果委员会验证欺诈证明通过，它将奖励挑战者并惩罚聚合者，议员在处理挑战者纠纷时，需要使用BFT算法进行快速确认。将在此处设置安全间隔。如果聚合器将数据上链，则验证者在验证过程中发现数据错误并在下一个块中发布。它在块之前广播。此时，挑战者获胜所获得的奖励最高。奖金将分发给国会议员。奖励的一小部分将分配给国库。当数据有误时，将用于申请赔偿。在治理模块中讨论。

### 如何解决纠纷？
![](assets/build/6.png)
Ares 网络的安全性由非常严格的 POS 保证，并带有处罚。如果节点运营商被认定为攻击者，他质押的所有Ares代币将分配给声誉委员会、挑战者和金库。

对应不同的数据市场，如DEFI，为了防止恶意报价，Ares设计了挑战者（任何Ares全节点）可以反对报价的挑战机制。发起挑战需要支付少量的 ARES 代币并将其广播给声誉委员会。假设信誉委员会有 2/3 的节点被审计为恶意节点。在这种情况下，他将被标记为恶意节点，抵押的代币被冻结，节点抵押的代币被转移到声誉委员会、挑战者和财政部。

但在极端情况下，当数据消费者因恶意节点上报数据而遭受损失时，他们可以向国库发起提案申请赔偿，然后通过社区投票，通过国库后，对数据消费者进行赔偿。
